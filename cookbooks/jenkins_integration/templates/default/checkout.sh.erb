#!/usr/bin/env bash
# Usage: vendor_git.sh name git-repo-path
source `dirname $0`/shared.inc

name=${1##*/}
name=${name%.git}

if [ ! -d $name ]; then
  echo "Checking out $1:"
  git clone $1
  cd $name
  for remote in `git branch -r | grep -v origin/master`; do
    git checkout -t remotes/$remote
  done
else
  echo "Updating $1:"
  cd $name
  git pull
  for remote in `git branch -r | grep -v origin/master`; do
    git checkout ${remote#*/}
    git pull
  done
fi
git checkout master
git submodule update --init
